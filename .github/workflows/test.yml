name: test.yml
on:
  push:
    branches:
      - main


jobs:
  determine-version:
    name: "Determine snapshot version to be published"
    runs-on: ubuntu-latest
    outputs:
      VERSION: ${{ steps.get-version.outputs.VERSION }}
      UPDATE-BADGE: ${{ steps.get-version.outputs.UPDATE-BADGE }}
    steps:
      - uses: actions/checkout@v5
      - name: "Get version"
        id: get-version
        run: |
          echo "VERSION=777.777.777.777-SNAPSHOT" >> "$GITHUB_OUTPUT"
          echo "UPDATE-BADGE=true" >> "$GITHUB_OUTPUT"

  update-snapshot-badge:
    name: 'Update Snapshot badge in README.md'
    permissions:
      contents: write
    needs: [ determine-version ]
    uses: ./.github/workflows/trigger-update-badge.yml
    secrets: inherit
    with:
      version: ${{ needs.determine-version.outputs.VERSION }}
      update-badge: ${{ needs.determine-version.outputs.UPDATE-BADGE }}